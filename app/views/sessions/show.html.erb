<dl>
	<dt>Topic:</dt>
	<dd><%= link_to @session.topic.name, @session.topic%></dd>
	<dt>Time:</dt>
	<dd><%=h @session.time %></dd>
	<dt>Location:</dt>
	<dd><%=h @session.location %></dd>
	<dt>Instructor:</dt>
	<dd><%=h @session.instructor.name %></dd>
	<dt>Description:</dt>
	<dd><%=h @session.topic.description %></dd>
	<dt>Duration:</dt>
	<dd><%=h @session.topic.minutes %> minutes</dd>
	<% if !@session.topic.url.blank? %>
		<dt>Additional Info:</dt>
		<dd><%= link_to @session.topic.url, @session.topic.url %></dd>
	<% end %>
	<dt>Registration:</dt>
	<dd>
		<% if @session.confirmed_reservations.size == 0 %>
			Nobody has registered for this session yet.
		<% elsif @session.confirmed_reservations.size == 1 %>
			There is currently 1 person registered for this session.
		<% else %>
			There are currently <%=h @session.confirmed_reservations.size %> people registered for this session.
		<% end %>
		
		<% if @session.seats_remaining != nil %>
			<% if @session.seats_remaining == 0 %>
				Registration for this class is full.
				<% if @session.waiting_list.size == 0 %>
					There is currently nobody on the waiting list.				
				<% elsif @session.waiting_list.size == 1 %>
					There is one person on the waiting list.
				<% else %>
					There are <%=h @session.waiting_list.size %> people on the waiting list.
				<% end %>
			<% elsif @session.seats_remaining == 1 %>
				There is one seat still available for this session.
			<% else %>
				There are <%=h @session.seats_remaining %> seats still available for this session.
			<% end %>
		<% end %>
	</dd>
</dl>

<% if @reservation %>
	<% if @reservation.confirmed? %>
		<p>You are registered for this session. </p>
	<% else %>
		<p>You are on the waiting list for this session.</p>
	<% end %>
	<div class="button-link confirm">
		<%= link_to "download to calendar", { :controller => :reservations, :action => :download, :id => @reservation.id } %>
	</div>
	<div class="button-link delete">
		<%= link_to "cancel reservation", @reservation, :method => :delete, :confirm => "Are you sure you want to cancel your reservation for \"" + @reservation.session.topic.name + "\"?"%>
	</div>
	
<% else %>		
	<% if @session.space_is_available? %>
		<div class="button-link confirm">
			<%= link_to "Register", new_session_reservation_path( @session ) %>
		</div>
		
	<% else %>
		<div class="button-link tentative">
			<%= link_to "add to waiting list", new_session_reservation_path( @session ) %>
		</div>
	<% end %>
<% end %>

<% if current_user.admin? or @session.instructor == current_user %>
	<% if @session.confirmed_reservations.size > 0 %>
		<div class="notice">
			<h2>Reservations:</h2>
			<ul>
			<% @session.confirmed_reservations.each do |reservation| %>
				<li><%=h reservation.user.name %> &lt;<%=h reservation.user.email %>&gt;</li>
			<% end%>
			</ul>
		</div>
	<% end %>

	<% if @session.waiting_list.size > 0 %>
		<div class="notice">
			<h2>Waiting List:</h2>
			<ul>
			<% @session.waiting_list.each do |reservation| %>
				<li><%=h reservation.user.name %> &lt;<%=h reservation.user.email %>&gt;</li>
			<% end%>
			</ul>
		</div>
	<% end %>

	<div class="button-link delete">
		<%= link_to "cancel session", @session, :confirm => "Are you sure you want to cancel this class? All registered attendees will be notified that the session has been cancelled.", :method => :delete %>
	</div>
<% end %>